---
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: wavefront-operator
  namespace: flux-system
spec:
  interval: 5m0s
  sourceRef:
    kind: GitRepository
    name: flux-system
  serviceAccountName: kustomize-controller
  path: ./infrastructure/observability-system
  prune: true
  ## Customize wavefront
  targetNamespace: observability-system
  patches:
    - patch: |-
        apiVersion: wavefront.com/v1alpha1
        kind: Wavefront
        metadata:
          name: wavefront
          namespace: observability-system
        spec:
          clusterName: dev
          wavefrontUrl: vmware.wavefront.com
          dataCollection:
            metrics:
              enable: true
            logging:
              enable: true
          dataExport:
            wavefrontProxy:
              enable: true
      target:
        name: wavefront
        kind: Wavefront